FROM ubuntu:20.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake libreadline-dev tclsh unzip
WORKDIR /root
RUN git clone https://github.com/lua/lua
WORKDIR /root/lua
RUN git checkout 1de95e97ef65632a88e08b6184bd9d1ceba7ec2f
RUN echo -n c2VkIC1pICcvXiMgVEVTVC9hXFRFU1RTPSAtZnNhbml0aXplPWFkZHJlc3MnIG1ha2VmaWxlCm1ha2UgLWo= | base64 -d > build.sh
RUN wget https://gist.github.com/c8ef/615a5faea1fbd056010a0c39dd5c78c7/raw/afd46129874fcb288a0f3a27bc2c6e400730f096/CVE-2021-44964.lua
RUN echo -n Li9sdWEgQ1ZFLTIwMjEtNDQ5NjQubHVhCg== | base64 -d > poc.sh
CMD ["/bin/bash"]

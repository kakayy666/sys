FROM ubuntu:20.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake libreadline-dev tclsh unzip
WORKDIR /root
RUN git clone https://github.com/LuaJIT/LuaJIT
WORKDIR /root/LuaJIT
RUN git checkout b025b01c5b9d23f6218c7d72b7aafa3f1ab1e08a
RUN echo -n c2VkIC1pICdzLyNDQ0RFQlVHPSAtZy9DQ0RFQlVHPSAtZy8nIHNyYy9NYWtlZmlsZQptYWtlIC1q | base64 -d > build.sh
RUN wget https://gist.github.com/c8ef/68b2419fa1d016cf9460d84e1a62aec4/raw/1180294a971b0999637c28e486252c3115acbaea/CVE-2019-19391.lua
RUN echo -n Li9zcmMvbHVhaml0IENWRS0yMDE5LTE5MzkxLmx1YQ== | base64 -d > poc.sh
CMD ["/bin/bash"]